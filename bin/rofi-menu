#!/usr/bin/env bash
# doc: show a menu using rofi (when X server is running) or fzf (when not) and return the selected item

[ "$(type -t include)" != 'function' ]&&{ include(){ { [ -z "$_IR" ]&&_IR="$PWD"&&cd "$(dirname "${BASH_SOURCE[0]}")"&&include "$1"&&cd "$_IR"&&unset _IR;}||{ local d="$PWD"&&cd "$(dirname "$PWD/$1")"&&. "$(basename "$1")"&&cd "$d";}||{ echo "Include failed $PWD->$1"&&exit 1;};};}
include "init/rofi.sh"

theme="Arc-Dark"

# Main logic: choose between rofi and fzf
if _rofi_is_x_server_running && _rofi_command_exists rofi; then
    # Use rofi when X server is running and rofi is available
    primary=$(_rofi_primary_monitor_id)
    rofi -dmenu -m $primary -i -theme "$theme"
elif _rofi_command_exists fzf; then
    # Fallback to fzf when X server is not running or rofi is not available
    fzf --prompt="Select: " --height=40% --reverse --border
else
    # Ultimate fallback to basic select if neither rofi nor fzf is available
    echo "Error: Neither rofi nor fzf is available" >&2
    exit 1
fi
